{% extends "base.html" %}

{% block body %}

<div class="wrapper">
    {% if user.is_authenticated %}
    <div class="content">
        <h2>Update Profile Settings</h2>
        
        <span class="required">*Required</span><br/><br />
        <form onsubmit="return validateSettings1()" action="/profileSettings/" method="POST" >
            {% csrf_token %}
            <div class="profileSettingsColLeft">
                <div class="profileSettingsColLeft">
                    <label for="first-name"><span class="required">*</span>First name</label>
                    <input required name="first-name" id="first-name" type="text" value="{{ user.firstName }}" /><br />
                    
                    <label for="last-name"><span class="required">*</span>Last name</label>
                    <input required name="last-name" id="last-name" type="text" value="{{ user.lastName }}" /><br />
                    
                    <label for="grade"><span class="required">*</span>Year In School</label><br />
                    <select name="grade">
                        <option id="grade-freshman">Freshmen</option>
                        <option id="grade-sophomore">Sophomore</option>
                        <option id="grade-junior">Junior</option>
                        <option id="grade-senior">Senior</option>
                    </select><br /><br />
                    <script>
                    var grade = '{{ recruit.grade }}';
                    if (grade === '' || grade == null) {
                        console.log('a');
                    } else if (grade === 'Freshman') {
                        console.log('b');
                        $('#grade-freshman').attr('selected','');
                    } else if (grade === 'Sophmore') {
                        console.log('c');
                        $('#grade-sophomore').attr('selected','');
                    } else if (grade === 'Junior') {
                        console.log('d');
                        $('#grade-junior').attr('selected','');
                    } else if (grade === 'Senior') {
                        console.log('e');
                        $('#grade-senior').attr('selected','');
                    }
                    </script>
                    
                    <label for="major">Major</label><br />
                    <input name="major" id="major" type="text" value="{{ recruit.major }}" />
                </div>
                <div class="profileSettingsColRight">
                    <label for="email"><span class="required">*</span>Email
                    <div class="form-error" id="email-invalid">Please enter a valid email address</div></label>
                    <input required id="email" name="email" type="text" value="{{ user.email }}" />
                    
                    <label for="phone-number"><span class="required">*</span>Phone number</label>
                    <input required id="phone-number" name="phone-number" type="text" value="{{ recruit.phone }}" />
                </div>
            </div>
            <div class="profileSettingsColRight">
                <label for="bio">Bio</label><br>
                <textarea id="bio" name="bio" style="resize:vertical;min-height:200px;width:100%;padding:5px"/>{{ recruit.bio }}</textarea>
            </div>
            <div class="clearfix"></div>
            
            <br />
            <input id="submit" type="submit" value="Update Settings" />
        </form>
        
        <br/><br/>
        
        <h2>Change Password</h2>
        <form onsubmit="return validateSettings2()" action="/profileSettings2/" method="POST" >
            
            {% csrf_token %}
            <label for="password1"><span class="required">*</span>Password</label>
            <input required id="password1" name="password1" type="password" />  
            
            <label for="password2"><span class="required">*</span>Confirm password
            <div class="form-error" id="password-mismatch">Passwords do not match</div></label>
            <input required id="password2" name="password2" type="password" />
            
            <br/>
            
            <input id="submit" type="submit" value="Change Password" />
        </form>
        <script>
        function validateSettings1() {
            if (!validateEmail($('#email').val())) {
                $('#email-invalid').fadeIn(100).delay(3000).fadeOut(300);
                return false;
            }
        }
        function validateSettings2() {
            if ($('#password1').val() !== $('#password2').val()) {
                $('#password-mismatch').fadeIn(100).delay(3000).fadeOut(300);
                return false;
            }
        }
        
        function validateEmail(email) { 
            var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(email);
        }
        </script>
        <style>
        .profileSettingsColLeft {
            width: 50%;
            padding: 10px;
            padding-left: 0;
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            float: left;
        }
        
        .profileSettingsColRight {
            width: 50%;
            padding: 10px;
            padding-right: 0;
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            float: right;
        }
        
        input {
            margin-bottom: 5px;
        }
        
        label {
            position: relative;
        }
        
        .form-error {
            display: none;
            position: absolute;
            margin-top: 15px;
            padding: 5px;
            box-sizing: border-box;
            -moz-box-sizing: border-box;
            background-color: #c04848;
            color: white;
            z-index: 99998;
            left: 100%;
            top: 0;
            margin-left: 15px;
            margin-top: 10px;
            min-width: 200px;
        }
        
        .form-error:before {
            content: "";
            position: absolute;
            border-bottom: 10px solid transparent;
            border-right: 12px solid #c04848;
            top: 0%;
            right: 100%;
        }
        </style>
    </div>
    {% else %}
    <div class="content">
        <p style="font-size: 17px;margin-top: 20px;margin-bottom: 500px;">You must be signed in to view this page.</p>
    </div>
    {% endif %}
</div>

{% endblock body %}
